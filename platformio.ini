[platformio]
default_envs = seeed_xiao_esp32s3

[env]
platform = https://github.com/pioarduino/platform-espressif32/releases/download/55.03.37/platform-espressif32.zip
framework = arduino
board_build.filesystem = littlefs
build_type = debug
monitor_filters = 
	default
	esp32_exception_decoder
; lib_ldf_mode = deep
lib_deps =
;    SPI
;    Wire
;	https://github.com/FastLED/FastLED.git
;	FastLED
;	lib/FastLED
	C:\Users\Jeff\Downloads\FastLED-6017ce6b94552fd57f5c0be60592902d8111b470.zip ; from 260223
	bblanchon/ArduinoJson @ ^7.4.2
build_flags = 
	-I src/programs
	-I src/reference
    -DDEBUG
;	-DFASTLED_DEBUG=1
;	-DFASTLED_LOG_RMT_ENABLED=0
    -DCORE_DEBUG_LEVEL=5
    -DLOG_LOCAL_LEVEL=ESP_LOG_VERBOSE
	-DARDUINO_USB_CDC_ON_BOOT=1
;	-DARDUINO_USB_MODE=0 ; Serial is native USB CDC (TinyUSB).
	-DARDUINO_USB_MODE=1 ;â†’ Serial is USB Serial/JTAG (hardware CDC).

[env:seeed_xiao_esp32s3]
board = seeed_xiao_esp32s3
board_build.flash_mode = qio
# Removed huge_app.csv - it prevented OTA and erased LittleFS on every upload
# Default partition scheme preserves filesystem during updates
build_flags =
	${env.build_flags}
	-DBOARD_HAS_PSRAM
	-DCONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=1
	-DCONFIG_ESP_SYSTEM_MEMPROT_FEATURE=0
upload_protocol = esptool
monitor_speed = 115200
debug_tool = esp-builtin
debug_server =
	$PLATFORMIO_CORE_DIR/packages/tool-openocd-esp32/bin/openocd
	-f
	$PROJECT_DIR/openocd_debug.cfg
debug_port = localhost:3333
debug_init_cmds =
	target extended-remote $DEBUG_PORT
	set remote hardware-watchpoint-limit 2
	set remote hardware-breakpoint-limit 2
	set remotetimeout 20
	monitor reset halt
	$LOAD_CMDS
	thbreak app_main
	continue

[env:esp32-p4]
board = esp32-p4
build_flags = 
	-DBOARD_HAS_PSRAM
