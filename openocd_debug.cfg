# Custom OpenOCD configuration for ESP32-S3 debugging
# This skips the problematic memory protection check

source [find board/esp32s3-builtin.cfg]

# Override the gdb-attach event to skip memory protection check
$_TARGETNAME_0 configure -event gdb-attach {
    halt 1000
    # Skip esp32s3_memprot_is_enabled check
    $_TARGETNAME_0 xtensa smpbreak BreakIn BreakOut
}

# Set the application image offset
$_TARGETNAME_0 configure -event reset-assert-post {
    soft_reset_halt
}

init
reset halt
